name: Windows-Litemanager

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-2022   # Use a fixed version instead of windows-latest
    timeout-minutes: 60     # Job will auto-cancel after 60 min
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Download & install essentials
        shell: powershell
        run: |
          Write-Host "Downloading Downloads.bat..."
          Invoke-WebRequest -Uri "https://gitlab.com/chamod12/1m_win-10_github_rdp/-/raw/main/Downloads.bat" -OutFile "Downloads.bat"
          Write-Host "Running Downloads.bat..."
          cmd /c Downloads.bat || exit /b %errorlevel%

      - name: Connect to LiteManager
        shell: cmd
        run: |
          echo Running show.bat...
          if exist show.bat (
            call show.bat
          ) else (
            echo ERROR: show.bat not found!
            exit /b 1
          )

      - name: Time Counter
        shell: cmd
        run: |
          echo Running loop.bat...
          if exist loop.bat (
            call loop.bat
          ) else (
            echo ERROR: loop.bat not found!
            exit /b 1
          )
